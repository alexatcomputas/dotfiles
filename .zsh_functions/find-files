#!/bin/sh

# Function: find-files
# Description: Recursively searches for files matching a given pattern within a specified directory depth.

# Arguments:
#   $1 (required): The search pattern (glob-style) for file names.
#   $2 (optional): The maximum depth for the recursive search (defaults to 1, the current directory).

# Usage:
#   find_files "*.txt"                # Find all .txt files in the current directory.
#   find_files "report*.pdf" 3        # Find all PDF files starting with "report" up to 3 levels deep.

# Output:
#   - Prints the executed 'find' command for transparency.
#   - Prints a "Searching..." message for user feedback.
#   - Lists the matching files (one per line), including their full paths.

# Notes:
#   - The search pattern uses glob-style matching, not regular expressions.
#   - The search is case-insensitive by default due to the '-iname' option.

find-files() {
    local search_pattern="$1"
    local path_depth="${2:-1}"  # Default to depth 1 if not specified

    # Use print for Zsh compatibility
    print -r -- "find -L -maxdepth $path_depth -type f -iname '$search_pattern'" 
    print "Searching..."
    print ""

    # Handle single-dot, double-dot, and regular files
    find -L -maxdepth "$path_depth" \
         \( -iname "$search_pattern" -o -name ".*" -o -name "..*" \) 
}
